# This workflow will build a Swift project
# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-swift

name: SwiftLint

on:
  push:
    branches: [ "**" ]
    
jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    # ë ˆí¬ ì²´í¬ì•„ì›ƒ
    - uses: actions/checkout@v4

    # SwiftLint ì‹¤í–‰
    - name: ğŸ§ª GitHub Action for SwiftLint ğŸ§ª
      uses: norio-nomura/action-swiftlint@3.2.1

    # 3. ê²°ê³¼ì— ë”°ë¼ Slack ë©”ì‹œì§€ ì „ì†¡ (ì„±ê³µ ì‹œ)
    - name: âœ… Send Slack Message on Success âœ…
      if: ${{ success() }}
      run: |
        curl -X POST --data-urlencode "payload={\"channel\": \"#lint-webhook\", \"username\": \"webhookbot\", \"text\": \"âœ… SwiftLint check passed for the latest commit in branch '$GITHUB_REF_NAME'.\", \"icon_emoji\": \":ghost:\"}" ${{ secrets.SLACK_LINT_WEBHOOK }}
      continue-on-error: true

    # 4. ê²°ê³¼ì— ë”°ë¼ Slack ë©”ì‹œì§€ ì „ì†¡ (ì‹¤íŒ¨ ì‹œ)
    - name: âŒ Send Slack Message on Failure âŒ
      if: ${{ failure() }}
      run: |
        curl -X POST --data-urlencode "payload={\"channel\": \"#lint-webhook\", \"username\": \"webhookbot\", \"text\": \"âŒ SwiftLint check fail: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}\", \"icon_emoji\": \":ghost:\"}"  ${{ secrets.SLACK_LINT_WEBHOOK }}
